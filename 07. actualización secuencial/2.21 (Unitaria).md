## 2.21
En un práctico para la Facultad un grupo de alumnos debe implementar una Red Social llamada UTNBook.
Para lo cual debe utilizar los siguientes archivos:

**Amigos** (ordenado por Cod_usuario y Cod_Amigo)
| Cod_usuario | Cod_amigo | Fecha_amistad | Mensaje_muro |
|-------------|-----------|---------------|--------------|

Cada registro indica la fecha desde que los usuarios son amigos y el último mensaje que un amigo ha
escrito en el muro del usuario.

**Notificaciones** (ordenado por Cod_usuario y Cod_Amigo)
| Cod_usuario | Cod_amigo | Cod_mov | Fecha_amistad | Mensaje_muro |
|-------------|-----------|---------|---------------|--------------|

Periódicamente se debe actualizar el archivo Amigos, con el fin de que refleje las amistades que posee
cada usuario. En el archivo notificaciones pueden existir tres tipos de acciones:
- la solicitud de una amistad (Cod_mov = “A”)
- la eliminación de una amistad (Cod_mov = “B”)
- la información de un mensaje que un amigo ha escrito en el muro del usuario (Cod_mov = “M”)

Considerar que la eliminación de una amistad implica la baja física de un registro y que hay un solo
registro de Notificaciones por cada registro de Amigo

```
ACCION ejercicio ES
  AMBIENTE
    HV = 999999

    Fecha = REGISTRO
      año: N(4)
      mes: 1..12
      dia: 1..31
    FIN_REGISTRO

    Amigo = REGISTRO
      cod_usuario: N(8)
      cod_amigo: N(4)
      fecha_amistad: Fecha
      mensaje: AN(300)
    FIN_REGISTRO

    Notificación = REGISTRO
      cod_usuario: N(8)
      cod_amigo: N(4)
      cod_mov: ('A', 'B', 'M')
      fecha_amistad: Fecha
      mensaje: AN(300)
    FIN_REGISTRO

    amigos, salida: archivo de Amigo ordenado por cod_usuario, cod_amigo
    regmae, regsal: Amigo
    notificaciones: archivo de Notificación ordenado por cod_usuario, cod_amigo
    regmov: Notificación

    PROCEDIMIENTO leer_amigos() ES
      LEER(amigos, regmae)
      SI FDA(amigos) ENTONCES
        regmae.cod_usuario := HV
      FIN_SI
    FIN_PROCEDIMIENTO

    PROCEDIMIENTO leer_notificaciones() ES
      LEER(notificaciones, regmov)
      SI FDA(notificaciones) ENTONCES
        regmov.cod_usuario := HV
      FIN_SI
    FIN_PROCEDIMIENTO
  PROCESO
    ABRIR E/ (amigos)
    ABRIR E/ (notificaciones)
    ABRIR /S (salida)

    leer_amigos()
    leer_notificaciones()

    MIENTRAS (regmae.cod_usuario <> HV) O (regmov.cod_usuario <> HV) HACER
      SI (regmae.cod_usuario < regmov.cod_usuario) ENTONCES
        regsal := regmae
        ESCRIBIR(salida, regsal)
        leer_amigos()
      CONTRARIO
        SI (regmae.cod_usuario > regmov.cod_usuario) ENTONCES
          SEGUN regmov.cod_mov HACER
            'A': regsal.cod_usuario := regmov.cod_usuario
                 regsal.cod_amigo := regmov.cod_amigo
                 regsal.fecha_amistad := regmov.fecha_amistad
                 regsal.mensaje := regmov.mensaje
                 ESCRIBIR(salida, regsal)
            'B': ESCRIBIR("ERROR: No se puede dar de baja un amigo inexistente: ", regmov.cod_usuario)
            'M': ESCRIBIR("ERROR: No se puede añadir al muro de un amigo inexistente: ", regmov.cod_usuario)
          FIN_SEGUN
          leer_notificaciones()
        CONTRARIO
          SEGUN regmov.cod_mov HACER
            'A': ESCRIBIR("ERROR: amigo previamente añadido: ", regmov.cod_usuario)
            'B': ESCRIBIR("Amigo borrado")
            'M': regsal := regmae
                 regsal.mensaje := regmov.mensaje
                 ESCRIBIR(salida, regsal)
          FIN_SEGUN
          leer_amigos()
          leer_notificaciones()
        FIN_SI
      FIN_SI
    FIN_MIENTRAS

    CERRAR(amigos)
    CERRAR(notificaciones)
    CERRAR(salida)
FIN_ACCION
```

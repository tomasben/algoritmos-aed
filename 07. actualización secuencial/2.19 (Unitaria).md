## 2.19
En una Empresa Farmacéutica se posee un archivo Mae_Remedios (ordenado por Clave: Farmacia + Medicamento),
el que se actualiza semanalmente, a traves de la información que se encuentra cargada en un archivo de
Movimientos (ordenado por Clavem: Farmacia + Medicamento, y Codmov), de la siguiente forma:
- Si Clave (Mae_Remedios) es menor que Clavem (Movimientos), simplemente se transfieren los datos del Maestro a
la salida y se graban.
- Si Clave (Mae_Remedios) es igual a Clavem (Movimientos) y el Codmov es 1, se considera error y se lista un
mensaje indicando el tipo de error; pero si el Codmov es 2, entonces es un remedio que deja de fabricarse y se
transfiere el registro al archivo de Remedios vencidos (Rem_Venc) ; pero si el Codmov es 3, se modifica la cantidad
actual con la cantidad recibida.
- Si Clave (Mae_Remedios) es mayor que Clavem (Movimientos) y el Codmov es 1, se incorpora el remedio a
nuestro Vademecum, considerando que la cantidad recibida configura la cantidad actual y la fecha-vence es 30 días
posterior a la fecha actual; pero si el Codmov es 2 o 3 se considera error y se deben producir los correspondientes
mensajes de error.
Se considera que sólo existe un registro de movimiento para cada registro del maestro.

MAE_REMEDIOS = MAESTRO_ACTUAL
REGR = REGA
| Farmacia | Medicamento | Cant-actual | Fecha-ven |
|----------|-------------|-------------|-----------|

MOVIMIENTOS
REGV
| Farmacia | Medicamento | Codmov | Cant-recibida |
|----------|-------------|--------|---------------|

REM_VENC
REGE
| Medicamento | Cant-vencida |
|-------------|--------------|

```
ACCION ejercicio ES
  AMBIENTE
    HV = 999999

    Remedio = REGISTRO
      clave = REGISTRO
        farmacia: AN(30)
        medicamento: AN(20)
      FIN_REGISTRO
      cant_act: entero
      vencimiento = REGISTRO
        año: N(4)
        mes: 1..12
        dia: 1..31
      FIN_REGISTRO
    FIN_REGISTRO

    Movimiento = REGISTRO
      clave = REGISTRO
        farmacia: AN(30)
        medicamento: AN(20)
      FIN_REGISTRO
      cod_mov: 1..3
      cant_rec: entero
    FIN_REGISTRO

    Med_Vencido = REGISTRO
      medicamento: AN(30)
      cant_venc: entero
    FIN_REGISTRO

    maestro: archivo de Remedio ordenado por farmacia, medicamento
    salida: archivo de Remedio
    regmae, regsal: Remedio
    movimiento: archivo de Movimiento ordenado por farmacia, medicamento, cod_mov
    regmov: Movimiento
    vencidos: archivo de Med_Vencido
    regven: Med_Vencido

    PROCEDIMIENTO leer_maestro() ES
      LEER(maestro, regmae)
      SI FDA(maestro) ENTONCES
        regmae.clave := HV
      FIN_SI
    FIN_PROCEDIMIENTO

    PROCEDIMIENTO leer_movimiento() ES
      LEER(movimiento, regmov)
      SI FDA(movimiento) ENTONCES
        regmov.clave := HV
      FIN_SI
    FIN_PROCEDIMIENTO
  PROCESO
    ABRIR E/ (maestro)
    ABRIR E/ (movimiento)
    ABRIR /S (vencidos)
    ABRIR /S (salida)

    leer_maestro()
    leer_movimiento()

    MIENTRAS (regmae.clave <> HV) O (regmov.clave <> HV) HACER
      SI regmae.clave < regmov.clave ENTONCES
        regsal := regmae
        ESCRIBIR(salida, regsal)
        leer_maestro()
      CONTRARIO
        SI regmae.clave = regmov.clave ENTONCES
          SEGUN regmov.cod_mod HACER
            1: ESCRIBIR("ERROR: el medicamento ya existe en el Vademecum")
            2: regvenc.medicamento := regmae.clave.medicamento
               regvenc.cant_venc := regmae.cant_act
               ESCRIBIR(vencimiento, regvenc)
            3: regsal := regmae
               regsal.cant_act := regmae.cant_act + regmov.cant_rec
               ESCRIBIR(salida, regsal)
          FIN_SEGUN
          leer_maestro()
          leer_movimiento()
        CONTRARIO <- regmae.clave > regmov.clave
          SEGUN regmov.clave HACER
            1: regsal.clave := regmov.clave
               regsal.cant_act := regmov.cant_rec
               regsal.vencimiento := (fecha_actual() + 30 dias) <- ??
               ESCRIBIR(salida, regsal)
            2: ESCRIBIR("ERROR: no puede darse de baja un medicamento inexistente ", regmov.clave.medicamento)
            3: ESCRIBIR("ERROR: no puede modificarse un medicamento inexistente ", regmov.clave.medicamento)
          FIN_SEGUN
          leer_movimiento()
        FIN_SI
      FIN_SI
    FIN_MIENTRAS

    CERRAR(maestro)
    CERRAR(movimiento)
    CERRAR(vencidos)
    CERRAR(salida)
FIN_ACCION
```
